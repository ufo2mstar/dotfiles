# # {"orderingRealm": "USAmazon", "marketplaceId": "ATVPDKIKX0DER", "eventType": "PaymentHardDeclined", "orderId": "902-6353659-5775039", "purchaseId": "903-3942233-0275839", "shipmentId": null, "daysUntilCancel": 2, "jamesQueryResults": {"isSmileOrder": false, "isOrderB2B": false, "isUFGOrder": false, "isOrderApprovalRequired": false, "containsPrimeSurpriseBoxBuildingItems": false, "orderHasMembershipItems": false, "isXAAOrder": false, "isOrderTeen": false, "isGamma": false, "isPpiOrder": false, "isZapposMafia": false, "hasPrimeNowInfo": false, "isAFN": true, "isOrderItemAssociation": false, "isHeavyBulkyScheduledDelivery": false, "isPharmacyOrder": false, "2": true, "isOrderSVA": false, "hasBudget": false, "isMomentsOrder": false, "isSarekOrder": false, "isHFCOrder": false, "isOwnerNile": false, "isFreshOrder": false, "isOrderCorporateGC": false, "isUpFrontChargeOrder": false, "isTrialOrder": false}}
# #
# # {"orderingRealm":"USAmazon","marketplaceId":"ATVPDKIKX0DER","eventType":"PaymentHardDeclined","orderId":"902-6353659-5775039","purchaseId":"903-3942233-0275839","shipmentId":null,"daysUntilCancel":2,"jamesQueryResults":{"isSmileOrder":false,"isOrderB2B":false,"isUFGOrder":false,"isOrderApprovalRequired":false,"containsPrimeSurpriseBoxBuildingItems":false,"orderHasMembershipItems":false,"isXAAOrder":false,"isOrderTeen":false,"isGamma":false,"isPpiOrder":false,"isZapposMafia":false,"hasPrimeNowInfo":false,"isAFN":true,"isOrderItemAssociation":false,"isHeavyBulkyScheduledDelivery":false,"isPharmacyOrder":false,"2":true,"isOrderSVA":false,"hasBudget":false,"isMomentsOrder":false,"isSarekOrder":false,"isHFCOrder":false,"isOwnerNile":false,"isFreshOrder":false,"isOrderCorporateGC":false,"isUpFrontChargeOrder":false,"isTrialOrder":false}}
# # 17:49
# # [exec] ControlPlane event:AsyncEventTrigger(eventTriggerId=urn:eeylops:etid:e1190014-a64e-486e-a089-59b5ecc67ad6, initialTriggerTime=2020-09-23T22:39:15.774Z, initialRenderFailureTime=Optional.empty, triggeringRetry=0, renderingRetry=0, stage=TEST, region=NA, blueprintName=OwenBlueprint, sourceEventJson={"marketplaceId":"1","jamesQueryResults":{"isSmileOrder":false,"isOrderB2B":false,"isUFGOrder":false,"isOrderApprovalRequired":false,"containsPrimeSurpriseBoxBuildingItems":false,"orderHasMembershipItems":false,"isXAAOrder":false,"isOrderTeen":false,"isGamma":false,"isPpiOrder":false,"isZapposMafia":false,"hasPrimeNowInfo":false,"isAFN":true,"isOrderItemAssociation":false,"isHeavyBulkyScheduledDelivery":false,"isPharmacyOrder":false,"2":true,"isOrderSVA":false,"hasBudget":false,"isMomentsOrder":false,"isSarekOrder":false,"isHFCOrder":false,"isOwnerNile":false,"isFreshOrder":false,"isOrderCorporateGC":false,"isUpFrontChargeOrder":false,"isTrialOrder":false},"orderId":"902-6353659-5775039","purchaseId":"903-3942233-0275839","daysUntilCancel":"2","orderingRealm":"USAmazon","eventType":"PaymentHardDeclined"}, predicateContextJsonOverride=Optional.empty, delayedEvalPredicateContextJsonOverride=Optional.empty)
# # [exec] SlapshotClient contractArgs key: stage, value: TEST
# # [exec] SlapshotClient contractArgs key: region, value: NA
# # [exec] SlapshotClient contractArgs key: sourceEvent, value: {"orderingRealm":"USAmazon","marketplaceId":"ATVPDKIKX0DER","eventType":"PaymentHardDeclined","orderId":"902-6353659-5775039","purchaseId":"903-3942233-0275839","shipmentId":null,"daysUntilCancel":2,"jamesQueryResults":{"isSmileOrder":false,"isOrderB2B":false,"isUFGOrder":false,"isOrderApprovalRequired":false,"containsPrimeSurpriseBoxBuildingItems":false,"orderHasMembershipItems":false,"isXAAOrder":false,"isOrderTeen":false,"isGamma":false,"isPpiOrder":false,"isZapposMafia":false,"hasPrimeNowInfo":false,"isAFN":true,"isOrderItemAssociation":false,"isHeavyBulkyScheduledDelivery":false,"isPharmacyOrder":false,"2":true,"isOrderSVA":false,"hasBudget":false,"isMomentsOrder":false,"isSarekOrder":false,"isHFCOrder":false,"isOwnerNile":false,"isFreshOrder":false,"isOrderCorporateGC":false,"isUpFrontChargeOrder":false,"isTrialOrder":false}}
#
# str = '[exec] ControlPlane event:AsyncEventTrigger(eventTriggerId=urn:eeylops:etid:e1190014-a64e-486e-a089-59b5ecc67ad6, initialTriggerTime=2020-09-23T22:39:15.774Z, initialRenderFailureTime=Optional.empty, triggeringRetry=0, renderingRetry=0, stage=TEST, region=NA, blueprintName=OwenBlueprint, sourceEventJson={"marketplaceId":"1","jamesQueryResults":{"isSmileOrder":false,"isOrderB2B":false,"isUFGOrder":false,"isOrderApprovalRequired":false,"containsPrimeSurpriseBoxBuildingItems":false,"orderHasMembershipItems":false,"isXAAOrder":false,"isOrderTeen":false,"isGamma":false,"isPpiOrder":false,"isZapposMafia":false,"hasPrimeNowInfo":false,"isAFN":true,"isOrderItemAssociation":false,"isHeavyBulkyScheduledDelivery":false,"isPharmacyOrder":false,"2":true,"isOrderSVA":false,"hasBudget":false,"isMomentsOrder":false,"isSarekOrder":false,"isHFCOrder":false,"isOwnerNile":false,"isFreshOrder":false,"isOrderCorporateGC":false,"isUpFrontChargeOrder":false,"isTrialOrder":false},"orderId":"902-6353659-5775039","purchaseId":"903-3942233-0275839","daysUntilCancel":"2","orderingRealm":"USAmazon","eventType":"PaymentHardDeclined"}, predicateContextJsonOverride=Optional.empty, delayedEvalPredicateContextJsonOverride=Optional.empty)'
# str1 = '(eventTriggerId=urn:eeylops:etid:e1190014-a64e-486e-a089-59b5ecc67ad6,
#  initialTriggerTime=2020-09-23T22:39:15.774Z,
#  initialRenderFailureTime=Optional.empty,
#  triggeringRetry=0,
#  renderingRetry=0,
#  stage=TEST,
#  region=NA,
#  blueprintName=OwenBlueprint,
#  sourceEventJson={"marketplaceId":"1",
# "jamesQueryResults":{"isSmileOrder":false,
# "isOrderB2B":false,
# "isUFGOrder":false,
# "isOrderApprovalRequired":false,
# "containsPrimeSurpriseBoxBuildingItems":false,
# "orderHasMembershipItems":false,
# "isXAAOrder":false,
# "isOrderTeen":false,
# "isGamma":false,
# "isPpiOrder":false,
# "isZapposMafia":false,
# "hasPrimeNowInfo":false,
# "isAFN":true,
# "isOrderItemAssociation":false,
# "isHeavyBulkyScheduledDelivery":false,
# "isPharmacyOrder":false,
# "2":true,
# "isOrderSVA":false,
# "hasBudget":false,
# "isMomentsOrder":false,
# "isSarekOrder":false,
# "isHFCOrder":false,
# "isOwnerNile":false,
# "isFreshOrder":false,
# "isOrderCorporateGC":false,
# "isUpFrontChargeOrder":false,
# "isTrialOrder":false},
# "orderId":"902-6353659-5775039",
# "purchaseId":"903-3942233-0275839",
# "daysUntilCancel":"2",
# "orderingRealm":"USAmazon",
# "eventType":"PaymentHardDeclined"},
#  predicateContextJsonOverride=Optional.empty,
#  delayedEvalPredicateContextJsonOverride=Optional.empty)'
#
# # req = str.gsub(/(\w+)=(.*)[,)]/,'"\1": "\2",')
# # str2 = str.scan(/AsyncEventTrigger\(.*\)/).first
# #
# require 'json'
#
# str2 = str
# str = str2.match(/AsyncEventTrigger\((.*)\)/).to_a[1]
# # req = str.gsub(/(\w+)=(.*)?[,)] ?/,'"\1": "\2",')
# # req = str.scan(/(\w+)=(.*?)[,)] /).map{|k,v| '"'+k+'": '+v.dump+', '}.join
# req = str.scan(/(\w+)=(.*?)[,)] /).map{|k,v| "#{k.dump}: #{v.dump}"}.join ', '
# req = "{#{req}}"
# puts str
# puts JSON.pretty_generate(JSON.parse(req))


require 'json'

str = ARGV[0]

unless str.nil?
  puts "\n#{str}\n"

  str = str.match(/AsyncEventTrigger\((.*)\)/).to_a[1]
  req = str.scan(/(\w+)=(.*?)[,)] /).map { |k, v| "#{k.dump}: #{v.dump}" }.join ', '
  req = "{#{req}}"

  puts "\n#{JSON.pretty_generate(JSON.parse(req))}\n"
else

end
